name: qss-m
sources:
  - type: archive
    url: https://api.github.com/repos/timbergeron/QSS-M/zipball/07001052df4c793625fa8077ed28a7b72995faa8
    sha256: b504b1565baa8ad825b5b8ebb435ad91471a4f0c81d64ae48224f7ed90dc2336
    dest-filename: qssm.zip
    x-checker-data:
      type: json
      url: https://api.github.com/repos/timbergeron/QSS-M/branches/qsrebase
      version-query: .commit.sha
      url-query: ("https://api.github.com/repos/timbergeron/QSS-M/zipball/" + .commit.sha)
  - type: file
    path: io.github.sezero.quakespasm.png
  - type: patch
    path: io.github.sezero.quakespasm.userdir_log.patch
  - type: patch
    path: com.quakeone.qssm.userdirs.patch
no-autogen: true
no-make-install: true
subdir: Quake
make-args:
  - DO_USERDIRS=1
  - USE_SDL2=1
  - QSS_LDFLAGS=-L/app/lib -Wl,--allow-multiple-definition
post-install:
  - install -D -m755 quakespasm /app/bin/qssm
  - install -D -m644 -t /app/bin/ qssm.pak
  - install -Dm644 ../io.github.sezero.quakespasm.png /app/share/icons/hicolor/256x256/apps/io.github.lavenderdotpet.LibreQuake.quakespasm.png
